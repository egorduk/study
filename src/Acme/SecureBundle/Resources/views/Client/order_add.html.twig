{% extends "AcmeSecureBundle::layout.html.twig" %}

{% block title "Create order" %}

    {% block content %}
        <div class="body">
            {% if (showWindow) %}
            <div id="success-window">
                <div class="Message Message--green" id="js-timer">
                    <div class="Message-icon">
                        <i class="fa fa-check"></i>
                    </div>
                    <div class="Message-body">
                        <p align="center">Ваши данные сохранены!</p>
                    </div>
                    <button class="Message-close js-messageClose"><i class="fa fa-times"></i></button>
                </div>
            </div>
            {% endif %}
            <div class="row">
                {{ form_start(formOrder) }}
                    {{ form_errors(formOrder) }}
                        {{ form_row(formOrder.fieldTheme) }}
                        {{ form_row(formOrder.fieldDescribe) }}
                        {{ form_row(formOrder.fieldDateExpire) }}
                        {{ form_row(formOrder.fieldOriginality) }}
                        {{ form_row(formOrder.fieldCountSheet) }}
                        {{ form_row(formOrder.selectorSubject) }}
                        {{ form_row(formOrder.selectorTypeWork) }}
                {{ form_end(formOrder) }}
                <a href="{{ path('secure_client_profile', {'type': 'view'}) }}">К профилю</a>
            </div>
            <script>
                $(document).ready(function() {
                    function sortingResults(results, container, query) {
                        if (query.term) {
                            return results.sort(function(a, b) {
                                if (a.text.length > b.text.length) {
                                    return 1;
                                } else if (a.text.length < b.text.length) {
                                    return -1;
                                } else {
                                    return 0;
                                }
                            });
                        }
                        return results;
                    }

                    $("#formCreateOrder_selectorSubject").select2({
                       // minimumResultsForSearch: -1,
                        placeholder: "Выберите предмет",
                        allowClear: true,
                        width: 300,
                        //minimumInputLength: 2,
                        maximumSelectionSize: 2,
                        sortResults: sortingResults

                        //minimumResultsForSearch: 1

                        //formatResult: format,
                        //formatSelection: format
                       // escapeMarkup: function(m) { return m; }
                    });

                    function closeMessage(el) {
                        el.addClass('is-hidden');
                    }

                    $('.js-messageClose').on('click', function(e) {
                        closeMessage($(this).closest('.Message'));
                    });

                    setTimeout(function() {
                        closeMessage($('#js-timer'));
                    }, 1500);
                });
            </script>
        </div>
    {% endblock %}